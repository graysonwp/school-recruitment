---
sidebar_position: 3
---

1. ARP协议完成了**IP地址**和**物理地址**的映射。
2. 每一个主机都设有一个ARP高速缓存，里面有**所在局域网**上的**各主机和路由器的IP地址到硬件地址的映射表**。
3. 当源主机要发送数据包到目的主机时，会先检查自己的ARP高速缓存中有没有目的主机的MAC地址：
   1. 如果有，就直接将数据包发送到这个MAC地址。
   2. 如果没有，就向**所在局域网**发起一个**ARP请求的广播包**（在发送自己的ARP请求时，同样会带上**自己的IP地址到硬件地址的映射**）。
4. 收到请求的主机检查自己的IP地址和目的主机IP地址是否一致，如果一致，则**保存源主机的映射到自己的ARP缓存**，然后给源主机发送一个**ARP响应数据包**。
5. 源主机收到响应数据包之后，先添加目的主机的IP地址与MAC地址的映射，再进行数据传送。
6. 如果源主机一直没有收到响应，表示ARP查询失败。
7. 如果所要找的主机和源主机**不在同一个局域网上**，那么就要**通过ARP找到一个位于本局域网上的某个路由器的硬件地址，然后把分组发给这个路由器，让这个路由器把分组转发给下一个网络，剩下的工作就由下一个网络来做**。
