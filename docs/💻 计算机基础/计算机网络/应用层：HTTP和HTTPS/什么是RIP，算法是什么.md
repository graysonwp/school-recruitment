---
sidebar_position: 6
---

## 1 简介

1. RIP全称是Routing Information Protocol，即**路由信息协议**，是一种较为简单的**内部网关协议**（Interior Gateway Protocol）。
2. 他通过**UDP**报文进行**路由信息的交换**，使用的端口号是520。

## 2 原理

1. RIP是一种基于**距离矢量**（DIstance-Vector）算法的协议，使用**跳数**（Hop Count）作为度量值来衡量**到达目的地址的距离**。
2. RIP属于**网络层**，主要应用于规模较小的，可靠性要求较低的网络，可以通过不断的交换信息让路由器动态的适应网络连接的变化，这些信息包括**每个路由器可以到达哪些网络，这些网络有多远**等。
3. 在RIP网络中，缺省情况下，**设备到他直接连接网络的跳数为0**，**通过一个设备可达的网络跳数为1**，其余以此类推，也就是说，**度量值等于从本网络到达目的网络间的设备数量**。
4. 为限制收敛时间，RIP规定**度量值取0~15之间的整数**，**大于或等于16的跳数被定义为无穷大**，即**目的网络或主机不可达**，由于这个限制，使得RIP不可能在大型网络中得到应用。

## 3 RIP路由表的形成过程

RIP启动时的**初始路由表**仅包含**本设备的一些直连接口路由**，通过**相邻设备互相学习路由表项**，才能实现**各网段路由互通**。

![rip 路由表形成过程](https://notebook.ricear.com/media/202105/2021-05-06_104111.png)

RIP路由表形成过程如上图所示：

1. RIP协议启动之后，RouterA会**向相邻的路由器广播一个Request报文**。
2. 当RouterB从接口接收到RouterA发送的Request报文后，**把自己的RIP路由表封装在Response报文内**，然后**向该接口对应的网络广播**。
3. RouterA**根据RouterB发送的Response报文，形成自己的路由表**。

## 4 优缺点

### 4.1 优点

1. 实现简单，开销较小。

### 4.2 缺点

1. RIP**限制了网路的规模**，它能使用的最大距离为15（16表示不可达）。
2. 路由器之间**交换的路由信息是路由器中的完成路由表**，因而**随着网络规模的扩大，开销也就增加**。
3. “**坏消息传播得慢**”，**使更新过程的收敛时间更长**，即当网络出现故障时，要经过较长的时间才能将此信息传递到所有路由器。

## 5 RIP协议中，为什么会出现坏消息传播的慢

![RIP 协议的缺点：坏消息传播得慢](https://notebook.ricear.com/media/202105/2021-05-06_113753.png)

1. 我们可以假设三个网络通道由两个路由器互联起来，并且都已建立了各自的路由表，图中路由器的交换信息只给出了我们感兴趣的一行内容：路由器$R_1$中的 `1，1，直接`表示`到网1的距离是1，直接交付`，路由器$R_2$中的 `1，2，R1`表示`到网1的距离是2，下一跳经过R1`。
2. 现在假定路由器$R_1$到网1的链路出现了故障，$R_1$无法到达网1，于是路由器$R_1$把到网1的距离改为16（表示到网1不可达），因而在$R_1$的路由表中的相应项目变为 `1，16，直接`。
3. 但是，很可能要经过30秒中后$R_1$才把更新信息发送给$R_2$，然而$R_2$可能已经先把自己的路由表发送给了$R_1$，其中有 `1，2，R1`。
4. $R_1$收到$R_2$的更新报文之后，误认为可经过$R_2$到达网1，于是把收到的路由信息 `1，2，R1`修改为`1，3，R2`，表明`我到网1的距离是3，下一条经过R2`，并把更新后的信息发送给$R_2$。
5. 同理，$R_2$接着又更新自己的路由表为 `1，4，R1`，以为`我到网1的距离是4，下一跳经过R1`。
6. 这样的更新一直持续下去，直到$R_1$和$R_2$到网1的距离都增大到16时，$R_1$和$R_2$才知道原来网1是不可达的。
7. RIP协议的这一特点叫做“好消息传播得快，坏消息传播得慢”，网络出故障的传播时间往往需要较长的时间（例如数分钟）。
8. 为了使坏消息传播得快些，可以采取多种措施，例如**让路由器记录收到某特定路由信息的接口，而不让同一路由信息再通过此接口向反方向传送**。

## 6 参考文献

1. [什么是RIP (距离矢量路由协议)?](https://github.com/wolverinn/Waking-Up/blob/master/Computer%20Network.md#%E4%BB%80%E4%B9%88%E6%98%AFRIP-Routing-Information-Protocol-%E8%B7%9D%E7%A6%BB%E7%9F%A2%E9%87%8F%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE-%E7%AE%97%E6%B3%95%E6%98%AF%E4%BB%80%E4%B9%88)
2. [RIP基础知识](https://cshihong.github.io/2018/03/23/RIP%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86)。
3. [计网学习笔记（14）- RIP 和 OSPF](https://www.jianshu.com/p/6d7d9c614440)。
4. [RIP协议的缺点：坏消息传播得慢](https://lichtmiao.github.io/2018/08/31/Tech/Computer%20Network/RIP%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%BC%BA%E7%82%B9%EF%BC%9A%E5%9D%8F%E6%B6%88%E6%81%AF%E4%BC%A0%E6%92%AD%E5%BE%97%E6%85%A2)。
